(self.webpackChunkmap_of_fame=self.webpackChunkmap_of_fame||[]).push([[709],{4709:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>D});var o=n(3144),r=n(5671),i=n(7326),a=n(9340),c=n(2963),u=n(1120),s=n(885),l=n(4234),f=n(5243),d=n.n(f),p=n(4861),v=n(8407),h=n(6130),m=n(9530),g=n(1469),y=n(8131),b=n(7739),w=n(4942),O=(n(5732),n(6959),n(8261)),I=n(3882);function k(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function L(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?k(Object(n),!0).forEach((function(e){(0,w.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var j=[],C=null,Z=[];y.$.subscribe((function(t){Z=t}));var M=function(t,e,n){var o,r;C=d().markerClusterGroup({chunkedLoading:!0,spiderfyOnMaxZoom:!0,showCoverageOnHover:!1,iconCreateFunction:I.uO,spiderLegPolylineOptions:{weight:0},elementsPlacementStrategy:"default",spiderfyDistanceMultiplier:2});var i=[];if(null==e||null===(o=e.spots)||void 0===o||o.forEach((function(t){var e,n=function(t){var e=t.id,n=t.location,o=n.lat,r=n.lng,i=t.icon,a=t.thumbnail,c=d().marker([o,r],{icon:(0,I.U3)(i||a,e)});return c.addEventListener("click",(function(){return function(t){var e=(0,O.U2)(y._l),n=t.id,o=t.spotStatus,r=t.img,i=t.title,a=t.videoLink,c=t.user,u=t.publicBanner,s=u.banner,l=u.bannerUrl,f=t.location,d=f.lat,p=f.lng;y.sr.set(L(L({},t),{},{status:o,img:{src:r,title:i||n},video:a,firm:{banner:s,bannerUrl:l},coords:{lat:d,lng:p}})),e("/@:username/spot/:id",{username:c.username,id:n}),y.n_.set(!1),document.getElementById("highlighted").innerHTML=""}(t)})),c}(t);n.isAdditionalCategory=null===(e=Z.find((function(e){return e.id===t.categoryId})))||void 0===e?void 0:e.isAdditional,C.addLayer(n),j.push(n),i.push(n)})),null==e||null===(r=e.clusters)||void 0===r||r.forEach((function(e){var n=function(t,e){var n=t.center,o=n.lat,r=n.lng,i=t.spotcnt,a=d().marker([o,r],{icon:(0,I.xM)(i)});return a.addEventListener("click",(function(){return e.setView([o,r],14)})),a}(e,t);n.count=e.spotcnt,C.addLayer(n),j.push(n),i.push(n)})),t.addLayer(C),n){var a=new(d().featureGroup)(i);t.fitBounds(a.getBounds())}window.dispatchEvent(h.S3)},$=function(t,e,n){var o,r;!function(t){j.length&&j.forEach((function(t){t.removeEventListener("click")})),C&&t.removeLayer(C),j=[]}(t),((null==e||null===(o=e.spots)||void 0===o?void 0:o.length)>0||(null==e||null===(r=e.clusters)||void 0===r?void 0:r.length)>0)&&M(t,e,n)};function S(t){var e,n,o,r,i,a=t[8].default,c=(0,l.nuO)(a,t,t[7],null);return{c:function(){e=(0,l.bGB)("div"),n=(0,l.DhX)(),c&&c.c(),(0,l.Ljt)(e,"class","map svelte-d2benj"),(0,l.VHj)(e,"add-mode",t[0]),(0,l.VHj)(e,"area-selection-mode",t[1])},m:function(a,u){(0,l.$Tr)(a,e,u),(0,l.$Tr)(a,n,u),c&&c.m(a,u),o=!0,r||(i=(0,l.TVh)(t[2].call(null,e)),r=!0)},p:function(t,n){var r=(0,s.Z)(n,1)[0];1&r&&(0,l.VHj)(e,"add-mode",t[0]),2&r&&(0,l.VHj)(e,"area-selection-mode",t[1]),c&&c.p&&(!o||128&r)&&(0,l.kmG)(c,a,t,t[7],o?(0,l.u2N)(a,t[7],r,null):(0,l.VOJ)(t[7]),null)},i:function(t){o||((0,l.Ui)(c,t),o=!0)},o:function(t){(0,l.etI)(c,t),o=!1},d:function(t){t&&(0,l.ogt)(e),t&&(0,l.ogt)(n),c&&c.d(t),r=!1,i()}}}function x(t,e,n){var o,r,i,a,c,u,s,f,w,O,I;(0,l.FIv)(t,y.DH,(function(t){return n(3,o=t)})),(0,l.FIv)(t,y.Nx,(function(t){return n(4,r=t)})),(0,l.FIv)(t,y.CM,(function(t){return n(5,i=t)})),(0,l.FIv)(t,y.UI,(function(t){return n(6,a=t)})),(0,l.FIv)(t,y.wI,(function(t){return n(9,c=t)})),(0,l.FIv)(t,y.dk,(function(t){return n(10,u=t)})),(0,l.FIv)(t,y.Qi,(function(t){return n(11,s=t)})),(0,l.FIv)(t,p.E9,(function(t){return n(12,f=t)})),(0,l.FIv)(t,y.VX,(function(t){return n(13,w=t)})),(0,l.FIv)(t,y.nN,(function(t){return n(0,O=t)})),(0,l.FIv)(t,y.Ir,(function(t){return n(1,I=t)}));var k=e.$$slots,L=void 0===k?{}:k,j=e.$$scope;y._l.set(f);var C=(0,h.Pt)("railwayMode");return y.wI.set(new v.T({onPolygonReady:function(t){y.Wz.set(!0),t.setStyle({color:"var(--color-accent)",weight:4,fillOpacity:.18});var e=t.toGeoJSON().geometry.coordinates;(0,b.LM)(e[0]).then((function(t){var e=t.result;y.VX.set(e),y.Wz.set(!1)}))},onPolygonDblClick:function(){var t;return!(null===(t=w)||void 0===t||!t.length)&&f("/selected-spots")},position:"bottomright"})),t.$$set=function(t){"$$scope"in t&&n(7,j=t.$$scope)},t.$$.update=function(){120&t.$$.dirty&&a&&i&&$(a,i,r||o)},[O,I,function(t){var e,n,l=C?[g.x,g.O]:[g.x];return y.UI.set(d().map(t,{layers:l})),a.zoomControl.setPosition("bottomleft"),s.length>0?(a.fitBounds(s),null!==(e=i)&&void 0!==e&&null!==(n=e.spots)&&void 0!==n&&n.length&&$(a,i,r||o)):(0,m.l6)(a),a.on("moveend",(function(){return u&&(0,m._Y)(a)})),a.on("zoomend",(function(){return y.H4.set(a.getZoom())})),a.addControl(c),{destroy:function(){a.remove(),y.UI.set(null)}}},o,r,i,a,j,L]}n(6785);const D=function(t){(0,a.Z)(f,t);var e,n,s=(e=f,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,o=(0,u.Z)(e);if(n){var r=(0,u.Z)(this).constructor;t=Reflect.construct(o,arguments,r)}else t=o.apply(this,arguments);return(0,c.Z)(this,t)});function f(t){var e;return(0,r.Z)(this,f),e=s.call(this),(0,l.S1n)((0,i.Z)(e),t,x,S,l.N8,{}),e}return(0,o.Z)(f)}(l.f_C)},3882:(t,e,n)=>{"use strict";n.d(e,{IH:()=>i,U3:()=>a,uO:()=>c,xM:()=>u});var o=n(5243),r=n.n(o),i=r().icon({iconUrl:"./images/new-marker.svg",iconSize:[44,60],iconAnchor:[22,60]}),a=function(t,e){return r().icon({iconUrl:t,iconSize:[56,56],className:"map-marker-with-photo marker-id-".concat(e)})},c=function(t){var e=t.getAllChildMarkers(),n=0,o=e.some((function(t){return"boolean"==typeof t.isAdditionalCategory}));return e.some((function(t){return"number"==typeof t.count}))&&e.forEach((function(t){var e;n+=null!==(e=t.count)&&void 0!==e?e:0})),o&&e.forEach((function(t){t.isAdditionalCategory||t.count||(n+=1)})),(Number.isNaN(n)||0===n&&!o)&&(n=t.getChildCount()),0!==n?r().divIcon({html:n<1e3?n:"".concat(Math.floor(n/1e3),"K"),className:"map-marker-cluster",iconSize:[56,56]}):r().divIcon({html:"",iconSize:[0,0]})},u=function(t){return r().divIcon({html:t<1e3?t:"".concat(Math.floor(t/1e3),"K"),className:"map-marker-cluster",iconSize:[56,56]})}},1469:(t,e,n)=>{"use strict";n.d(e,{O:()=>u,x:()=>c});var o=n(5243),r=n.n(o),i=n(6897);r().TileLayer.Grayscale=r().TileLayer.extend({options:{quotaRed:21,quotaGreen:71,quotaBlue:8,quotaDividerTune:0,quotaDivider:function(){return this.quotaRed+this.quotaGreen+this.quotaBlue+this.quotaDividerTune}},initialize:function(t,e){(e=e||{}).crossOrigin=!0,r().TileLayer.prototype.initialize.call(this,t,e),this.on("tileload",(function(t){this._makeGrayscale(t.tile)}))},_createTile:function(){var t=r().TileLayer.prototype._createTile.call(this);return t.crossOrigin="Anonymous",t},_makeGrayscale:function(t){if(!t.getAttribute("data-grayscaled")){t.crossOrigin="";var e=document.createElement("canvas");e.width=t.width,e.height=t.height;var n=e.getContext("2d");n.drawImage(t,0,0);for(var o=n.getImageData(0,0,e.width,e.height),r=o.data,i=0,a=r.length;i<a;i+=4)r[i]=r[i+1]=r[i+2]=(this.options.quotaRed*r[i]+this.options.quotaGreen*r[i+1]+this.options.quotaBlue*r[i+2])/this.options.quotaDivider();n.putImageData(o,0,0),t.setAttribute("data-grayscaled",!0),t.src=e.toDataURL()}}});var a,c=("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",a={minZoom:i.Zj,maxZoom:i.sZ,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',fadeAnimation:!1,crossOrigin:"*"},new(r().TileLayer.Grayscale)("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",a)),u=r().tileLayer("https://{s}.tiles.openrailwaymap.org/standard/{z}/{x}/{y}.png",{minZoom:i.Zj,maxZoom:i.sZ,attribution:'Map data: &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors | Map style: &copy; <a href="https://www.OpenRailwayMap.org">OpenRailwayMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'})},6785:()=>{}}]);