import{S as W,i as X,s as Y,G as H,b2 as J,I as E,a as T,H as I,aC as K,K as b,b as se,m as L,az as m,ad as re,a$ as ae,b3 as O,h as k,b0 as oe,ba as Q,t as R,l as ne,d as $,T as A,aw as x,aJ as ie,bo as le,aF as ue,aQ as Z,bk as me,bj as fe,aZ as B,bl as pe}from"./index-09f9502f.js";import{f as U,M as de}from"./Modal-7bbfe9bb.js";import{l as ge}from"./auth-f14ad06a.js";import{B as ce}from"./ButtonPrimary-61920e22.js";import{F as _e}from"./FormEmailInput-10424246.js";import{F as we}from"./FormPasswordInput-2f5cf029.js";import"./globals-7f7f1b26.js";import"./endpoints-b6cf54a2.js";function be(a){let t,e,o,l,i,d,c,s,u,h,S,y,f,D,v,F,C,r,P,_,p,g,M,G;function ee(n){a[9](n)}let V={placeholder:"Email",errorText:a[0].email};a[1]!==void 0&&(V.value=a[1]),e=new _e({props:V}),H.push(()=>J(e,"value",ee)),e.$on("input",a[10]);function te(n){a[11](n)}let j={placeholder:"Password",errorText:a[0].password};return a[2]!==void 0&&(j.value=a[2]),i=new we({props:j}),H.push(()=>J(i,"value",te)),i.$on("input",a[12]),f=new ce({props:{text:"Login",type:"submit",className:"wide",isDisabled:a[3]}}),{c(){t=E("form"),T(e.$$.fragment),l=I(),T(i.$$.fragment),c=I(),s=E("div"),u=E("a"),h=K("Forgot password"),y=I(),T(f.$$.fragment),D=I(),v=E("div"),F=E("span"),F.textContent="Don't have an account?",C=I(),r=E("a"),P=K("Sign up"),b(u,"href",S=a[4]("/forgot-password")),b(u,"class","svelte-1c7a6e1"),b(s,"class","forgot-password svelte-1c7a6e1"),b(r,"href",_=a[4](a[5].needInviteToRegister?"/begistration":"/registration")),b(r,"class","svelte-1c7a6e1"),b(v,"class","switch-to-sign-up svelte-1c7a6e1"),t.noValidate=!0,b(t,"class","svelte-1c7a6e1")},m(n,w){se(n,t,w),L(e,t,null),m(t,l),L(i,t,null),m(t,c),m(t,s),m(s,u),m(u,h),m(t,y),L(f,t,null),m(t,D),m(t,v),m(v,F),m(v,C),m(v,r),m(r,P),g=!0,M||(G=re(t,"submit",ae(a[6])),M=!0)},p(n,[w]){const N={};w&1&&(N.errorText=n[0].email),!o&&w&2&&(o=!0,N.value=n[1],O(()=>o=!1)),e.$set(N);const q={};w&1&&(q.errorText=n[0].password),!d&&w&4&&(d=!0,q.value=n[2],O(()=>d=!1)),i.$set(q),(!g||w&16&&S!==(S=n[4]("/forgot-password")))&&b(u,"href",S);const z={};w&8&&(z.isDisabled=n[3]),f.$set(z),(!g||w&48&&_!==(_=n[4](n[5].needInviteToRegister?"/begistration":"/registration")))&&b(r,"href",_)},i(n){g||(k(e.$$.fragment,n),k(i.$$.fragment,n),k(f.$$.fragment,n),oe(()=>{g&&(p||(p=Q(t,U,{duration:200},!0)),p.run(1))}),g=!0)},o(n){R(e.$$.fragment,n),R(i.$$.fragment,n),R(f.$$.fragment,n),p||(p=Q(t,U,{duration:200},!1)),p.run(0),g=!1},d(n){n&&ne(t),$(e),$(i),$(f),n&&p&&p.end(),M=!1,G()}}}function he(a,t,e){let o,l,i;A(a,x,r=>e(13,o=r)),A(a,ie,r=>e(4,l=r)),A(a,le,r=>e(5,i=r));let d="",c="",s={email:"",password:""},u=!1,h=!1;const S=()=>{const r=pe(d);if(!r||!c){d?r?e(0,s.email="",s):e(0,s.email=B.emailInvalid,s):e(0,s.email=B.emailEmpty,s),e(0,s.password=c?"":B.passwordEmpty,s);return}e(0,s.email="",s),e(0,s.password="",s)},y=()=>{S(),!s.email&&!s.password&&(e(8,h=!0),ge(d,c).then(r=>{var p,g;const{success:P,result:_}=r||{};P&&_?(ue.set(_),Z.set(!0),me("token",_.token),fe.set(_.isNewbie),o("/")):(e(8,h=!1),(p=r.errors)!=null&&p.email&&e(0,s.email=r.errors.email,s),(g=r.errors)!=null&&g.login&&e(0,s.email=r.errors.login,s),Array.isArray(r.errors)&&e(0,s.password=r.errors[0],s))}).catch(r=>{console.error(r),e(8,h=!1),Z.set(!1),e(0,s.password="Something went wrong",s)}))},f=r=>{if(u||s.password||s.email){if(s.email){e(0,s={email:"",password:""}),e(3,u=!1);return}e(0,s[r]="",s),e(3,u=!!(s.password||s.email))}};function D(r){d=r,e(1,d)}const v=()=>f("email");function F(r){c=r,e(2,c)}const C=()=>f("password");return a.$$.update=()=>{a.$$.dirty&257&&e(3,u=!!s.email||!!s.password||h)},[s,d,c,u,l,i,y,f,h,D,v,F,C]}class ve extends W{constructor(t){super(),X(this,t,he,be,Y,{})}}function Se(a){let t,e;return t=new ve({}),{c(){T(t.$$.fragment)},m(o,l){L(t,o,l),e=!0},i(o){e||(k(t.$$.fragment,o),e=!0)},o(o){R(t.$$.fragment,o),e=!1},d(o){$(t,o)}}}function Ee(a){let t,e;return t=new de({props:{id:"login-modal",title:"Log in",withFooter:!0,$$slots:{default:[Se]},$$scope:{ctx:a}}}),t.$on("close",a[1]),{c(){T(t.$$.fragment)},m(o,l){L(t,o,l),e=!0},p(o,[l]){const i={};l&4&&(i.$$scope={dirty:l,ctx:o}),t.$set(i)},i(o){e||(k(t.$$.fragment,o),e=!0)},o(o){R(t.$$.fragment,o),e=!1},d(o){$(t,o)}}}function Fe(a,t,e){let o;return A(a,x,i=>e(0,o=i)),[o,()=>o("/")]}class Ce extends W{constructor(t){super(),X(this,t,Fe,Ee,Y,{})}}export{Ce as default};
