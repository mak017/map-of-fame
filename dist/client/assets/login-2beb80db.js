import{S as W,i as X,s as Z,G as K,b1 as O,I,a as T,H as F,aA as Y,K as b,b as se,m as L,ax as m,ad as re,a_ as ae,b2 as z,h as k,a$ as oe,b9 as J,t as R,l as ne,d as $,T as C,au as x,aI as ie,bn as le,aE as ue,aP as Q,bj as me,bi as fe,aY as B,bk as pe}from"./index-b97375a6.js";import{f as U,M as de}from"./Modal-eca6e7db.js";import{l as ge}from"./auth-42cd4e99.js";import{B as ce}from"./ButtonPrimary-548ded10.js";import{F as _e}from"./FormEmailInput-88c0115f.js";import{F as we}from"./FormPasswordInput-eac48a02.js";import"./globals-7f7f1b26.js";import"./endpoints-5fb45e2d.js";function be(a){let t,e,o,l,i,d,c,s,u,h,E,y,f,D,v,S,P,r,A,_,p,g,M,G;function ee(n){a[9](n)}let V={placeholder:"Email",errorText:a[0].email};a[1]!==void 0&&(V.value=a[1]),e=new _e({props:V}),K.push(()=>O(e,"value",ee)),e.$on("input",a[10]);function te(n){a[11](n)}let j={placeholder:"Password",errorText:a[0].password};return a[2]!==void 0&&(j.value=a[2]),i=new we({props:j}),K.push(()=>O(i,"value",te)),i.$on("input",a[12]),f=new ce({props:{text:"Login",type:"submit",className:"wide",isDisabled:a[3]}}),{c(){t=I("form"),T(e.$$.fragment),l=F(),T(i.$$.fragment),c=F(),s=I("div"),u=I("a"),h=Y("Forgot password"),y=F(),T(f.$$.fragment),D=F(),v=I("div"),S=I("span"),S.textContent="Don't have an account?",P=F(),r=I("a"),A=Y("Sign up"),b(u,"href",E=a[4]("/forgot-password")),b(u,"class","svelte-1c7a6e1"),b(s,"class","forgot-password svelte-1c7a6e1"),b(r,"href",_=a[4](a[5].needInviteToRegister?"/begistration":"/registration")),b(r,"class","svelte-1c7a6e1"),b(v,"class","switch-to-sign-up svelte-1c7a6e1"),t.noValidate=!0,b(t,"class","svelte-1c7a6e1")},m(n,w){se(n,t,w),L(e,t,null),m(t,l),L(i,t,null),m(t,c),m(t,s),m(s,u),m(u,h),m(t,y),L(f,t,null),m(t,D),m(t,v),m(v,S),m(v,P),m(v,r),m(r,A),g=!0,M||(G=re(t,"submit",ae(a[6])),M=!0)},p(n,[w]){const N={};w&1&&(N.errorText=n[0].email),!o&&w&2&&(o=!0,N.value=n[1],z(()=>o=!1)),e.$set(N);const q={};w&1&&(q.errorText=n[0].password),!d&&w&4&&(d=!0,q.value=n[2],z(()=>d=!1)),i.$set(q),(!g||w&16&&E!==(E=n[4]("/forgot-password")))&&b(u,"href",E);const H={};w&8&&(H.isDisabled=n[3]),f.$set(H),(!g||w&48&&_!==(_=n[4](n[5].needInviteToRegister?"/begistration":"/registration")))&&b(r,"href",_)},i(n){g||(k(e.$$.fragment,n),k(i.$$.fragment,n),k(f.$$.fragment,n),oe(()=>{g&&(p||(p=J(t,U,{duration:200},!0)),p.run(1))}),g=!0)},o(n){R(e.$$.fragment,n),R(i.$$.fragment,n),R(f.$$.fragment,n),p||(p=J(t,U,{duration:200},!1)),p.run(0),g=!1},d(n){n&&ne(t),$(e),$(i),$(f),n&&p&&p.end(),M=!1,G()}}}function he(a,t,e){let o,l,i;C(a,x,r=>e(13,o=r)),C(a,ie,r=>e(4,l=r)),C(a,le,r=>e(5,i=r));let d="",c="",s={email:"",password:""},u=!1,h=!1;const E=()=>{const r=pe(d);if(!r||!c){d?r?e(0,s.email="",s):e(0,s.email=B.emailInvalid,s):e(0,s.email=B.emailEmpty,s),e(0,s.password=c?"":B.passwordEmpty,s);return}e(0,s.email="",s),e(0,s.password="",s)},y=()=>{E(),!s.email&&!s.password&&(e(8,h=!0),ge(d,c).then(r=>{var p,g;const{success:A,result:_}=r||{};A&&_?(ue.set(_),Q.set(!0),me("token",_.token),fe.set(_.isNewbie),o("/")):(e(8,h=!1),(p=r.errors)!=null&&p.email&&e(0,s.email=r.errors.email,s),(g=r.errors)!=null&&g.login&&e(0,s.email=r.errors.login,s),Array.isArray(r.errors)&&e(0,s.password=r.errors[0],s))}).catch(r=>{console.error(r),e(8,h=!1),Q.set(!1),e(0,s.password="Something went wrong",s)}))},f=r=>{if(u||s.password||s.email){if(s.email){e(0,s={email:"",password:""}),e(3,u=!1);return}e(0,s[r]="",s),e(3,u=!!(s.password||s.email))}};function D(r){d=r,e(1,d)}const v=()=>f("email");function S(r){c=r,e(2,c)}const P=()=>f("password");return a.$$.update=()=>{a.$$.dirty&257&&e(3,u=!!s.email||!!s.password||h)},[s,d,c,u,l,i,y,f,h,D,v,S,P]}class ve extends W{constructor(t){super(),X(this,t,he,be,Z,{})}}function Ee(a){let t,e;return t=new ve({}),{c(){T(t.$$.fragment)},m(o,l){L(t,o,l),e=!0},i(o){e||(k(t.$$.fragment,o),e=!0)},o(o){R(t.$$.fragment,o),e=!1},d(o){$(t,o)}}}function Ie(a){let t,e;return t=new de({props:{id:"login-modal",title:"Log in",withFooter:!0,$$slots:{default:[Ee]},$$scope:{ctx:a}}}),t.$on("close",a[1]),{c(){T(t.$$.fragment)},m(o,l){L(t,o,l),e=!0},p(o,[l]){const i={};l&4&&(i.$$scope={dirty:l,ctx:o}),t.$set(i)},i(o){e||(k(t.$$.fragment,o),e=!0)},o(o){R(t.$$.fragment,o),e=!1},d(o){$(t,o)}}}function Se(a,t,e){let o;return C(a,x,i=>e(0,o=i)),[o,()=>o("/")]}class Pe extends W{constructor(t){super(),X(this,t,Se,Ie,Z,{})}}export{Pe as default};
