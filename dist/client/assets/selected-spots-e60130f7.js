import{S as F,i as K,s as P,aR as y,I as S,H as Y,a as C,K as _,b as q,az as v,m as L,h as g,g as te,t as w,f as se,l as B,d as I,T,aw as W,a9 as N,b7 as le,aI as ae,o as ne,M as H,e as oe,ay as re,a_ as O,ad as ie,b0 as ce,b1 as ue,aU as A,ac as fe,ap as me,ao as pe,ab as de,aT as _e,aV as ge,aW as he}from"./index-09f9502f.js";import{e as V}from"./each-d91c6e2f.js";import{f as ve,M as ke}from"./Modal-7bbfe9bb.js";import{a as be}from"./init-9beff97c.js";import{C as Se}from"./CustomSelect-962b759c.js";import{S as $e}from"./ShowOnMapButton-bfdd46bb.js";import"./globals-7f7f1b26.js";import"./auth-f14ad06a.js";import"./endpoints-b6cf54a2.js";import"./spot-3b7b98da.js";import"./transformers-2ad5cf36.js";import"./SelectIndicatorSvg-a0421dfe.js";function z(a,s,t){const e=a.slice();return e[15]=s[t],e}function D(a){let s,t;return s=new $e({props:{onClick:a[5]}}),{c(){C(s.$$.fragment)},m(e,l){L(s,e,l),t=!0},p:H,i(e){t||(g(s.$$.fragment,e),t=!0)},o(e){w(s.$$.fragment,e),t=!1},d(e){I(s,e)}}}function G(a){let s,t=V(a[1]),e=[];for(let l=0;l<t.length;l+=1)e[l]=U(z(a,t,l));return{c(){for(let l=0;l<e.length;l+=1)e[l].c();s=oe()},m(l,n){for(let o=0;o<e.length;o+=1)e[o]&&e[o].m(l,n);q(l,s,n)},p(l,n){if(n&18){t=V(l[1]);let o;for(o=0;o<t.length;o+=1){const f=z(l,t,o);e[o]?(e[o].p(f,n),g(e[o],1)):(e[o]=U(f),e[o].c(),g(e[o],1),e[o].m(s.parentNode,s))}for(;o<e.length;o+=1)e[o].d(1);e.length=t.length}},i(l){for(let n=0;n<t.length;n+=1)g(e[n])},o:H,d(l){l&&B(s),re(e,l)}}}function U(a){let s,t,e,l,n,o,f,k;function $(){return a[9](a[15])}return{c(){s=S("button"),t=S("img"),o=Y(),_(t,"loading","lazy"),O(t.src,e=a[15].thumbnail)||_(t,"src",e),_(t,"alt",l=a[15].title??`Spot ${a[15].id} from area`),_(t,"class","svelte-s84lk8"),_(s,"class","button spot-card svelte-s84lk8")},m(m,p){q(m,s,p),v(s,t),v(s,o),f||(k=ie(s,"click",$),f=!0)},p(m,p){a=m,p&2&&!O(t.src,e=a[15].thumbnail)&&_(t,"src",e),p&2&&l!==(l=a[15].title??`Spot ${a[15].id} from area`)&&_(t,"alt",l)},i(m){n||ce(()=>{n=ue(t,ve,{duration:200}),n.start()})},o:H,d(m){m&&B(s),f=!1,k()}}}function we(a){let s,t,e,l,n,o,f,k,$,m,p;f=new Se({props:{items:a[2],selectedValue:{value:a[0],label:a[0]},isYear:!0}}),f.$on("select",a[3]);let i=a[0]===y&&D(a),c=a[1]&&G(a);return{c(){s=S("div"),t=S("div"),t.innerHTML='<div class="title svelte-s84lk8">Selected spots</div>',e=Y(),l=S("div"),n=S("div"),o=S("div"),C(f.$$.fragment),k=Y(),i&&i.c(),$=Y(),m=S("div"),c&&c.c(),_(t,"class","top svelte-s84lk8"),_(o,"class","year-select svelte-s84lk8"),_(n,"class","data-top svelte-s84lk8"),_(m,"class","spots svelte-s84lk8"),_(l,"class","data svelte-s84lk8"),_(s,"class","container svelte-s84lk8")},m(u,h){q(u,s,h),v(s,t),v(s,e),v(s,l),v(l,n),v(n,o),L(f,o,null),v(n,k),i&&i.m(n,null),v(l,$),v(l,m),c&&c.m(m,null),p=!0},p(u,[h]){const M={};h&4&&(M.items=u[2]),h&1&&(M.selectedValue={value:u[0],label:u[0]}),f.$set(M),u[0]===y?i?(i.p(u,h),h&1&&g(i,1)):(i=D(u),i.c(),g(i,1),i.m(n,null)):i&&(te(),w(i,1,1,()=>{i=null}),se()),u[1]?c?(c.p(u,h),h&2&&g(c,1)):(c=G(u),c.c(),g(c,1),c.m(m,null)):c&&(c.d(1),c=null)},i(u){p||(g(f.$$.fragment,u),g(i),g(c),p=!0)},o(u){w(f.$$.fragment,u),w(i),p=!1},d(u){u&&B(s),I(f),i&&i.d(),c&&c.d()}}}function Me(a,s,t){let e,l,n,o;T(a,W,r=>t(11,e=r)),T(a,N,r=>t(7,l=r)),T(a,le,r=>t(8,n=r)),T(a,ae,r=>t(12,o=r));let f=!0;if(ne(()=>{N.set([]),f||(document.getElementById("highlighted").innerHTML="")}),!(n!=null&&n.length)&&!(l!=null&&l.length)){const{poly:r}=o;console.log("poly",r);const d=r==null?void 0:r.split("/").reduce((b,R)=>{const E=R.split(",");return b.push(E),b},[]);(d==null?void 0:d.length)<4||!(d!=null&&d.every(b=>b.length===2))?e("/"):(be(d),f=!1)}const k=()=>l!=null&&l.length?l:n,$=()=>[y,...new Set(n==null?void 0:n.map(({year:r})=>r===null?A:r).filter(r=>r).sort((r,d)=>(r===A)-(d===A)||-(r>d)||+(r<d)))];let m=y,p=k(),i=p,c=$();const u=r=>{const{value:d}=r.detail.detail;t(0,m=d!==A?d:null),t(1,i=m===y?p:p.filter(b=>b.year===m))},h=r=>{const{id:d,spotStatus:b,img:R,title:E,videoLink:J,publicBanner:{banner:Q,bannerUrl:X},location:{lat:Z,lng:x},user:ee}=r;fe.set({...r,status:b,img:{src:R,title:E||d},video:J,firm:{banner:Q,bannerUrl:X},coords:{lat:Z,lng:x}}),e("/@:username/spot/:id",{username:ee.username,id:d})},M=()=>{me.set({spots:p,years:c}),pe.set(!0),de.set(!0),_e.set(m),ge.set(""),he.set(""),e("/")},j=r=>h(r);return a.$$.update=()=>{a.$$.dirty&448&&(n||l)&&(t(6,p=k()),t(1,i=p),t(2,c=$()))},[m,i,c,u,h,M,p,l,n,j]}class Te extends F{constructor(s){super(),K(this,s,Me,we,P,{})}}function ye(a){let s,t;return s=new Te({}),{c(){C(s.$$.fragment)},m(e,l){L(s,e,l),t=!0},i(e){t||(g(s.$$.fragment,e),t=!0)},o(e){w(s.$$.fragment,e),t=!1},d(e){I(s,e)}}}function Ae(a){let s,t;return s=new ke({props:{id:"selected-spots-modal",noLogo:!0,$$slots:{default:[ye]},$$scope:{ctx:a}}}),s.$on("close",a[1]),{c(){C(s.$$.fragment)},m(e,l){L(s,e,l),t=!0},p(e,[l]){const n={};l&4&&(n.$$scope={dirty:l,ctx:e}),s.$set(n)},i(e){t||(g(s.$$.fragment,e),t=!0)},o(e){w(s.$$.fragment,e),t=!1},d(e){I(s,e)}}}function Ye(a,s,t){let e;return T(a,W,n=>t(0,e=n)),[e,()=>{e("/")}]}class De extends F{constructor(s){super(),K(this,s,Ye,Ae,P,{})}}export{De as default};
